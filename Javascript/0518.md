# 0518 공부를 해 볼까용 
# Lazy Loading
    이걸 알았다면 용량을 좀 줄일 수 있었곘지..
imgage Lazy Loading은 페이지 안에 실제 이미지들이 실제로 화면에 보여질 필요가 있을 때 로딩을 할 수 있도록 하는 테크닉. 
  웹 페이지 내에서 바로 로딩을 하지 않고 로딩 시점을 뒤로 미루는 것이라 볼 수 있다. 
    이 방식은 웹 성능과 디바이스 내 리소스 활용도 증가, 그리고 연관된 비용을 줄이는데 도움을 줄 수 있습니다.

  영어 단어 중 'lazy'는 '가능한 길게 일을 미루는 행위' 라는 뜻에 기반!

  유사하게, lazy loadingd은 페이지 내에서 실제로 필요로 할 때까지 리소스의 로딩을 미루는것.

  페이지를 로드하자마자 리소스를 로딩하는 일반적인 방식 대신 실제로 사용자 화면에서 보여질 필요가 있을 때까지 이러한 로딩을 지연하는 것

  lazy loading을 다루는 방식은 페이지 내의 거의 모든 리소스에 적용할 수 있습니다. 
    예를 들어, SPA(Single Page Application ) 내에서 JS 파일이 나중에까지 필요하지 않으면 초기에 로드해서 가져오지 않는 것이 가장 좋다! 이처럼 이미지도 바로 보여질 필요가 없다가 실제로 보여질 필요가 있을 때 로딩을 하는것이다. 
___

# 왜 lazy loading을 사용해야 할까? 
      Lazy Loading은 페이지 내에서 바로 필요하지 않은 이미지들의 로딩 시점을 뒤로 미루는 것! 

      페이지 로드 시점에 유저에게 보여지지 않는 이미지는 스크롤 등으로 실제로 이미지가 보여지는 시점이 올 때 로딩된다.

      만약 사용자가 스크롤하는 행위가 없으면 사용자에게 보여지지 않은 이미지는 절대로 로딩되지 않는다.

# 그렇다면 장점은?
  ## 1. 성능 향상
    이것은 웹 사이트의 로딩 시간, 성능 관리 면에서 가장 중요한 요소 중 하나이다. 

    lazy loading을 이용하면 페이지 초기 로딩 시 필요로 한 이미지의 수를 줄일 수 있다. 리소스 요청을 줄이는 것은 다운로드 bytes를 줄이는 것이며, 이는 유저가 사용할 수 있는 제한된 네트워크 대역폭의 경쟁을 줄이는 것을 의미한다.

    이것은 디바이스가 다른 리소스들을 더 빠르게 처리해서 다운로드 하도록 확보하는것. 그러므로 lazy loading을 쓰지 않는 것에 비해서 페이지를 훨씬 빨리 유저가 이용하게 되는 것. 
  ## 2. 비용 감소
    두 번째 장점 ! 통신 비용 관점에 있다.
      이미지 전달 또는 다른 전달할 무언가는 주로 전송 바이트 수에 기반하여 총구됌.

    lazy loading에 앞서 언급했듯이, 이미지가 보여지지 않으면 절대 로딩하지 않으므로 페이지 내에서 전달할 총 바이트 용량을 줄일 수 있다.
      특히나 페이지를 이탈하거나 페이지의 제일 상단에만 서비스를 이용하는 유저에게 효과적이다.
    이처럼 네트워크로부터 전송 될 바이트의 감소는 전송 비용을 줄인다.
     이 부분은 lazy loading에 대하여 더 알아보자!!! 
# 어떤 이미지에 Lazy Loading을 적용할 수 있을까? 

    lazy loading의 기본적인 방법은 매우 간단하다. 지금 당장 필요하지 않은 모든 요소들을 잠시 감춰서 로딩을 지연하는 것. 따라서 사용자 화면에 보여지지 않는 이미지들은 로딩을 지연시킬 수 있다. 

      사용자가 페이지에서 스크롤을 아래로 내림으로서 이미지의 placeholder는 뷰포트에 다가오게된다.(웹 페이지 내 보여지는 부분!)
      뷰 포트에 보여지게 되면 이미지를 로딩하도록 트리거를 일으킨다. 
  ## lazy loading 에 대해 도움 받을 수 있는 링크들 

 - [Google Lighthouse audit tool]
  https://developers.google.com/web/tools/lighthouse/

 - ImageKit's website analyzer
  https://imagekit.io/website-analyzer/?utm_source=lazyblog&utm_medium=blog

# Lazy Loading을 다루는 여러가지 기술
    웹 페이지 내 이미지는 두 가지 방법으로 로드할 수 있다. 
    1. <img> 태그
    2. CSS background attribute
  ## 1. 이미지 태그를 이용한 일반적 방법
     Lazy Loading 이미지들은 두 단계로 나눌 수 있다.

  <strong>이미지 로딩을 사전에 막는 것</strong>
  ___
   일반적으로 <img>태그를 이용해서 이미지를 로드하기 위해서, 브라우저는 태그 내 src 속성을 이용한다. HTML 내 첫번째 이미지든 1000번째 이미지이든, 혹은 뷰포트 밖에 있든 상관없이 만약 브라우저가 src 속성을 가지면 이미지를 무조건 로드한다. 

  그러므로 이와 같은 이미지들의 로딩을 지연시키려면, src 속성 대신 다른 속성에다가 이미지 URL을 넣는 것입니다.
    우리가 img 태그의 data-src 라는 속성에 이미지 URL을 지정했다고 가정해보면 src는 비워져있고 브라우저는 해당 이미지를 로드하지 않는다. 

  ```html
  <img data-src="http://cdn.psychiatricnews.net/news/photo/201905/15267_11665_4637.jpg">
  ```

  ~~링크는 나으사랑 하울....~~
  위 방식으로 이미지 로드를 사전에 막았으니 이제는 브라우저에게 해당 이미지를 언제 로딩할 것인지 알려주어야 한다.

  이를 위해서 ! 해당 이미지(지금은 just placeholoder!) 가 뷰포트에 들어오자마자 로딩할 수 있도록 확인해야한다.

## _" 어떻게 확인하는데???? "_

  ### 1. 자바스크립트를 이용하여 image load를 일으키는 방법. 
  브라우저 내 scroll, resize 그리고 orientatioChange 이벤트 리스너를 이용할 수 있다.


  - _scroll 이벤트는 사용자가 페이지에서 스크롤하는 시점을 확인할 수 있다._


  - _resize와 orientationChange 이벤트는 Lazy loading을 위해서는 함께 사용해야 한다._
  
   - _resize 이벤트는 윈도우 브라우저 크기가 바뀔 때 발생한다._

   - _orientationChange 이벤트는 디바이스 화면이 가로에서 세로모드로 바뀔 때 발생한다._ 이처럼 가로, 세로모드를 변경하는 것은 화면 내 보여지는 이미지의 수가 바뀔 수 있으므로 이미지들을 로드하는 트리거가 필요하다. 

  이 이벤트들 중 하나가 발생할 때 로딩이 지연되었거나 아직 로딩되지 않은 이미지들을 모두 찾는다. 윈도우 높이, 현재 스크롤 위치, 그리고 이미지의 위치를 이용하여 어떤 이미지가 뷰포트 안으로 들어왔는지 확인하게 된다.
    뷰포트 안으로 들어가면 img 태그의 data-src 속성에 지정된 url을 src 속성에 넣어서 이미지를 로드한다..

  이후 나중에 트리거 이벤트를 일으키기 위해 로딩을 지연시킬 이미지로 식별하던 lazy 클래스를 제거한다. 모든 이미지가 로딩되면 그때 트리거를 일으키던 이벤트 리스너를 제거하게 된다. 

  

